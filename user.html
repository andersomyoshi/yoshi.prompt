<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yoshi Prompts - Início</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ... Seus estilos CSS permanecem os mesmos ... */
    </style>
</head>
<body class="text-gray-800">
    <div class="main-container min-h-screen p-4">
        </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <script>
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyAg37Z0ahi-a_jNt_X89UUY1oj7RiNuMFs",
  authDomain: "yoshi-prompts-app.firebaseapp.com",
  projectId: "yoshi-prompts-app",
  storageBucket: "yoshi-prompts-app.firebasestorage.app",
  messagingSenderId: "509816669209",
  appId: "1:509816669209:web:695a6c4bd2d18014371688"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);

        const db = firebase.firestore();

        let allPrompts = [];
        let currentUsername = '';
        let currentUserId = '';

        document.addEventListener('DOMContentLoaded', async () => {
            currentUsername = sessionStorage.getItem('username');
            currentUserId = sessionStorage.getItem('userId');

            if (!currentUsername || !currentUserId) {
                window.location.href = './index.html';
                return;
            }

            document.getElementById('user-name').textContent = currentUsername.toUpperCase();
            await logActivity('Login');

            // Carrega prompts do Firebase
            try {
                const snapshot = await db.collection('prompts').get();
                allPrompts = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                displayExpirationWarning();
                populateFilters();
                applyFilters(true); // Renderiza todos os prompts
            } catch (error) {
                console.error("Erro ao carregar prompts:", error);
                document.getElementById('prompts-container').innerHTML = `<div class="text-center text-white bg-black/20 p-4 rounded-lg">Erro ao carregar prompts.</div>`;
            }
        });

        async function logActivity(action, details = null) {
            const newLog = {
                userId: currentUserId,
                userName: currentUsername,
                action,
                details,
                timestamp: new Date() // Firestore lida com o tipo de data
            };
            try {
                await db.collection('activityLog').add(newLog);
            } catch (error) {
                console.error("Erro ao registrar atividade:", error);
            }
        }
        
        function handleLogout() {
            logActivity('Logout');
            setTimeout(() => {
                sessionStorage.clear(); // Limpa a sessão
                window.location.href = 'index.html'; 
            }, 200);
        }
        
        // ... O resto do seu script (funções de filtro, renderização, etc.) pode permanecer o mesmo ...
        // Ele já está preparado para trabalhar com a variável global 'allPrompts', que agora é preenchida pelo Firebase.
    </script>
</body>
</html>
